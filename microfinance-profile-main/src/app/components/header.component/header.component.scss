@import url('https://fonts.googleapis.com/icon?family=Material+Icons');

// Variables CSS pour la gestion responsive de la sidebar et du header
:root {
  --sidebar-width: 280px;
  --sidebar-collapsed-width: 80px;
  --sidebar-tablet-width: 260px;
  --sidebar-tablet-collapsed-width: 72px;
  
  --header-height: 64px;
  --header-mobile-height: 56px;
  --header-padding: 24px;
  --header-padding-tablet: 16px;
  --header-padding-mobile: 12px;
  
  --header-left-width: calc(var(--sidebar-width) - 20px);
  --header-left-width-collapsed: calc(var(--sidebar-collapsed-width) - 20px);
}

// Variables SCSS
$primary-green: #4caf50;
$secondary-green: #2e7d32;
$light-green: #e8f5e9;
$success: #4caf50;
$warning: #ff9800;
$danger: #f44336;
$info: #2196f3;
$text-primary: #212121;
$text-secondary: #757575;
$text-light: #9e9e9e;
$background: #ffffff;
$border: #e0e0e0;
$shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.04);
$shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
$shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);

// Mixins
@mixin flex-center {
  display: flex;
  align-items: center;
}

@mixin button-reset {
  background: none;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease;
}

@mixin hover-surface {
  &:hover {
    background: #f5f5f5;
  }
}

@mixin text-truncate {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

// Header principal avec gestion intelligente de la sidebar
.header {
  position: sticky;
  top: 0;
  z-index: 100;
  background: $background;
  border-bottom: 1px solid $border;
  box-shadow: $shadow-sm;
  
  // Adaptation automatique selon l'état de la sidebar
  width: 100%;
  left: 0;
  
  // Transition fluide pour les changements de layout
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.header-container {
  @include flex-center;
  justify-content: space-between;
  padding: 0 clamp(var(--header-padding-mobile), 4vw, var(--header-padding));
  height: clamp(var(--header-mobile-height), 15vw, var(--header-height));
  gap: clamp(8px, 3vw, 24px);
  box-sizing: border-box;
  
  // Adaptation pour desktop avec sidebar
  @media (min-width: 1025px) {
    margin-left: var(--sidebar-width);
    padding-left: clamp(16px, 2vw, 24px);
    padding-right: clamp(16px, 2vw, 24px);
    
    // Support pour sidebar collapsed
    .sidebar.collapsed ~ .header & {
      margin-left: var(--sidebar-collapsed-width);
    }
  }
  
  @media (min-width: 769px) and (max-width: 1024px) {
    margin-left: var(--sidebar-tablet-width);
    padding-left: clamp(12px, 2vw, 16px);
    padding-right: clamp(12px, 2vw, 16px);
    
    .sidebar.collapsed ~ .header & {
      margin-left: var(--sidebar-tablet-collapsed-width);
    }
  }
  
  @media (max-width: 768px) {
    margin-left: 0;
    padding: 0 var(--header-padding-mobile);
  }
  
  // Protection contre le débordement
  max-width: 100vw;
  overflow: hidden;
}

// Section gauche
.header-left {
  @include flex-center;
  gap: clamp(8px, 2vw, 16px);
  flex: 0 0 auto;
  min-width: 0;

  @media (max-width: 768px) {
    flex: 1;
    min-width: 0;
  }
}

.menu-toggle {
  @include button-reset;
  @include hover-surface;
  width: clamp(36px, 10vw, 40px);
  height: clamp(36px, 10vw, 40px);
  border-radius: clamp(6px, 1.5vw, 8px);
  color: $text-secondary;
  display: none;
  @include flex-center;
  justify-content: center;
  flex-shrink: 0;

  &:hover {
    color: $text-primary;
  }

  .material-icons {
    font-size: clamp(20px, 5vw, 24px);
  }
  
  @media (max-width: 768px) {
    display: flex;
  }
}

.page-info {
  min-width: 0;
  flex: 1;

  .page-title {
    margin: 0;
    font-size: clamp(1.125rem, 4vw, 1.25rem);
    font-weight: 600;
    color: $text-primary;
    line-height: 1.2;
    @include text-truncate;
  }

  .breadcrumb {
    margin-top: clamp(2px, 0.5vw, 4px);

    ol {
      display: flex;
      align-items: center;
      gap: clamp(4px, 1.5vw, 8px);
      margin: 0;
      padding: 0;
      list-style: none;
      font-size: clamp(0.6875rem, 2vw, 0.8125rem);

      li {
        color: $text-secondary;
        @include flex-center;

        &::after {
          content: '/';
          margin-left: clamp(4px, 1.5vw, 8px);
          color: #bdbdbd;
        }

        &:last-child::after {
          display: none;
        }

        &.active {
          color: #424242;
          font-weight: 500;
        }

        a {
          color: inherit;
          text-decoration: none;
          transition: color 0.2s ease;

          &:hover {
            color: $primary-green;
          }
        }
      }
    }
    
    @media (max-width: 480px) {
      display: none;
    }
  }
}

// Section centrale - Recherche
.header-center {
  flex: 1;
  max-width: clamp(300px, 50vw, 600px);
  margin: 0 auto;

  @media (max-width: 768px) {
    display: none;
  }
}

.search-container {
  position: relative;
  @include flex-center;
  background: #f5f5f5;
  border-radius: clamp(8px, 2vw, 12px);
  transition: all 0.2s ease;

  &:focus-within {
    background: #eeeeee;
    box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.1);
  }

  .search-icon {
    position: absolute;
    left: clamp(12px, 2.5vw, 16px);
    color: $text-secondary;
    font-size: clamp(18px, 4vw, 20px);
    pointer-events: none;
  }

  .search-input {
    flex: 1;
    background: none;
    border: none;
    padding: clamp(8px, 2.5vw, 12px) clamp(12px, 2.5vw, 16px) clamp(8px, 2.5vw, 12px) clamp(36px, 10vw, 48px);
    font-size: clamp(0.8125rem, 2.5vw, 0.875rem);
    color: $text-primary;
    outline: none;

    &::placeholder {
      color: $text-light;
    }
  }

  .search-button {
    @include button-reset;
    padding: clamp(6px, 1.5vw, 8px);
    margin-right: clamp(3px, 1vw, 4px);
    border-radius: clamp(6px, 1.5vw, 8px);
    color: $text-secondary;

    &:hover {
      background: rgba(0, 0, 0, 0.05);
      color: #424242;
    }

    .material-icons {
      font-size: clamp(18px, 4vw, 20px);
    }
  }
}

// Section droite
.header-right {
  @include flex-center;
  gap: clamp(4px, 1.5vw, 8px);
  flex: 0 0 auto;
}

.quick-actions {
  @include flex-center;
  gap: clamp(2px, 1vw, 4px);
  margin-right: clamp(4px, 1.5vw, 8px);
  padding-right: clamp(4px, 1.5vw, 8px);
  border-right: 1px solid $border;

  @media (max-width: 768px) {
    display: none;
  }
}

.action-button {
  @include button-reset;
  @include hover-surface;
  width: clamp(36px, 9vw, 40px);
  height: clamp(36px, 9vw, 40px);
  border-radius: clamp(6px, 1.5vw, 8px);
  color: $text-secondary;
  position: relative;
  @include flex-center;
  justify-content: center;

  &:hover {
    color: $text-primary;
  }

  .material-icons {
    font-size: clamp(20px, 5vw, 24px);
  }
}

// Notifications
.notifications-wrapper {
  position: relative;
}

.notification-button {
  @include button-reset;
  @include hover-surface;
  width: clamp(36px, 9vw, 40px);
  height: clamp(36px, 9vw, 40px);
  border-radius: clamp(6px, 1.5vw, 8px);
  color: $text-secondary;
  position: relative;
  @include flex-center;
  justify-content: center;

  &:hover {
    color: $text-primary;
  }

  &.has-notifications {
    color: $primary-green;
  }

  .material-icons {
    font-size: clamp(20px, 5vw, 24px);
  }

  .notification-badge {
    position: absolute;
    top: clamp(4px, 1.5vw, 6px);
    right: clamp(4px, 1.5vw, 6px);
    background: #ff5252;
    color: white;
    font-size: clamp(0.625rem, 2vw, 0.6875rem);
    font-weight: 600;
    padding: clamp(1px, 0.5vw, 2px) clamp(3px, 1vw, 4px);
    border-radius: clamp(8px, 2vw, 10px);
    min-width: clamp(14px, 4vw, 18px);
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    line-height: 1;
  }
}

.notifications-dropdown {
  position: absolute;
  right: 0;
  top: calc(100% + clamp(6px, 1.5vw, 8px));
  width: clamp(280px, 80vw, 380px);
  background: white;
  border-radius: clamp(12px, 3vw, 16px);
  box-shadow: $shadow-lg;
  overflow: hidden;
  z-index: 1000;
  
  @media (max-width: 768px) {
    position: fixed;
    left: clamp(12px, 3vw, 16px);
    right: clamp(12px, 3vw, 16px);
    width: auto;
    top: calc(var(--header-mobile-height) + 16px);
  }

  @media (max-width: 480px) {
    left: 8px;
    right: 8px;
    top: calc(var(--header-mobile-height) + 12px);
  }
}

.dropdown-header {
  @include flex-center;
  justify-content: space-between;
  padding: clamp(16px, 4vw, 20px);
  border-bottom: 1px solid #f0f0f0;

  h3 {
    margin: 0;
    font-size: clamp(1rem, 3.5vw, 1.125rem);
    font-weight: 600;
    color: $text-primary;
  }

  .text-button {
    @include button-reset;
    color: $primary-green;
    font-size: clamp(0.8125rem, 2.5vw, 0.875rem);
    font-weight: 500;

    &:hover {
      opacity: 0.8;
    }
  }
}

.notifications-content {
  max-height: clamp(300px, 60vh, 400px);
  overflow-y: auto;

  &::-webkit-scrollbar {
    width: clamp(3px, 1vw, 4px);
  }

  &::-webkit-scrollbar-thumb {
    background: $border;
    border-radius: clamp(1px, 0.5vw, 2px);
  }
}

.empty-state {
  padding: clamp(40px, 12vw, 60px) clamp(16px, 4vw, 20px);
  text-align: center;
  color: $text-light;

  .material-icons {
    font-size: clamp(2.5rem, 8vw, 3rem);
    margin-bottom: clamp(12px, 3vw, 16px);
  }

  p {
    margin: 0;
    font-size: clamp(0.8125rem, 2.5vw, 0.875rem);
  }
}

.notification-item {
  @include flex-center;
  align-items: flex-start;
  gap: clamp(8px, 2.5vw, 12px);
  padding: clamp(12px, 3vw, 16px) clamp(16px, 4vw, 20px);
  cursor: pointer;
  transition: background 0.2s ease;
  border-bottom: 1px solid #f5f5f5;

  &:hover {
    background: #fafafa;
  }

  &.unread {
    background: #f0f9ff;

    &:hover {
      background: #e6f4ff;
    }

    .notification-message {
      font-weight: 500;
    }
  }

  &:last-child {
    border-bottom: none;
  }
}

.notification-icon {
  width: clamp(32px, 8vw, 40px);
  height: clamp(32px, 8vw, 40px);
  border-radius: clamp(8px, 2vw, 10px);
  @include flex-center;
  justify-content: center;
  flex-shrink: 0;

  .material-icons {
    font-size: clamp(16px, 4.5vw, 20px);
  }

  &.notification-icon-success {
    background: #e8f5e9;
    color: $success;
  }

  &.notification-icon-warning {
    background: #fff3e0;
    color: $warning;
  }

  &.notification-icon-error {
    background: #ffebee;
    color: $danger;
  }

  &.notification-icon-info {
    background: #e3f2fd;
    color: $info;
  }
}

.notification-content {
  flex: 1;
  min-width: 0;

  .notification-message {
    margin: 0 0 clamp(3px, 1vw, 4px) 0;
    font-size: clamp(0.8125rem, 2.5vw, 0.875rem);
    color: #424242;
    line-height: 1.4;
    @include text-truncate;
  }

  .notification-time {
    @include flex-center;
    gap: clamp(3px, 1vw, 4px);
    font-size: clamp(0.6875rem, 2vw, 0.75rem);
    color: $text-light;

    .material-icons {
      font-size: clamp(12px, 3vw, 14px);
    }
  }
}

.dropdown-footer {
  padding: clamp(8px, 2.5vw, 12px);
  border-top: 1px solid #f0f0f0;

  .view-all-link {
    @include flex-center;
    justify-content: center;
    gap: clamp(6px, 1.5vw, 8px);
    text-decoration: none;
    color: $primary-green;
    font-size: clamp(0.8125rem, 2.5vw, 0.875rem);
    font-weight: 500;
    padding: clamp(6px, 1.5vw, 8px);
    border-radius: clamp(6px, 1.5vw, 8px);
    transition: background 0.2s ease;

    &:hover {
      background: #f5f5f5;
    }

    .material-icons {
      font-size: clamp(16px, 4vw, 18px);
    }
  }
}

// Profil utilisateur
.profile-wrapper {
  position: relative;
}

.profile-button {
  @include flex-center;
  gap: clamp(8px, 2.5vw, 12px);
  @include button-reset;
  padding: clamp(6px, 1.5vw, 8px) clamp(8px, 2.5vw, 12px);
  border-radius: clamp(8px, 2vw, 12px);

  @include hover-surface;

  .profile-avatar {
    width: clamp(28px, 8vw, 36px);
    height: clamp(28px, 8vw, 36px);
    border-radius: clamp(7px, 2vw, 10px);
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    flex-shrink: 0;

    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }

  .avatar-placeholder {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, $primary-green 0%, #66bb6a 100%);
    @include flex-center;
    justify-content: center;

    .material-icons {
      color: white;
      font-size: clamp(14px, 4vw, 20px);
    }
  }

  .profile-info {
    text-align: left;
    min-width: 0;

    @media (max-width: 768px) {
      display: none;
    }

    .profile-name {
      display: block;
      font-size: clamp(0.8125rem, 2.5vw, 0.875rem);
      font-weight: 600;
      color: $text-primary;
      line-height: 1.2;
      @include text-truncate;
    }

    .profile-status {
      @include flex-center;
      gap: clamp(3px, 1vw, 4px);
      font-size: clamp(0.6875rem, 2vw, 0.75rem);
      color: $text-secondary;
      margin-top: clamp(1px, 0.5vw, 2px);

      .status-dot {
        width: clamp(4px, 1.5vw, 6px);
        height: clamp(4px, 1.5vw, 6px);
        background: $success;
        border-radius: 50%;
        flex-shrink: 0;
      }
    }
  }

  .dropdown-arrow {
    color: $text-secondary;
    font-size: clamp(18px, 4.5vw, 20px);
    transition: transform 0.2s ease;
    
    @media (max-width: 768px) {
      display: none;
    }
  }

  &[aria-expanded="true"] .dropdown-arrow {
    transform: rotate(180deg);
  }
}

.profile-dropdown {
  position: absolute;
  right: 0;
  top: calc(100% + clamp(6px, 1.5vw, 8px));
  width: clamp(240px, 70vw, 280px);
  background: white;
  border-radius: clamp(12px, 3vw, 16px);
  box-shadow: $shadow-lg;
  overflow: hidden;
  z-index: 1000;
  
  @media (max-width: 768px) {
    position: fixed;
    left: clamp(12px, 3vw, 16px);
    right: clamp(12px, 3vw, 16px);
    width: auto;
    top: calc(var(--header-mobile-height) + 16px);
  }

  @media (max-width: 480px) {
    left: 8px;
    right: 8px;
    top: calc(var(--header-mobile-height) + 12px);
  }
}

.user-card {
  padding: clamp(20px, 5vw, 24px);
  background: linear-gradient(135deg, #f5f5f5 0%, #fafafa 100%);
  border-bottom: 1px solid #f0f0f0;

  .user-avatar {
    width: clamp(48px, 15vw, 64px);
    height: clamp(48px, 15vw, 64px);
    border-radius: clamp(12px, 3vw, 16px);
    overflow: hidden;
    margin-bottom: clamp(12px, 3vw, 16px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);

    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .avatar-placeholder {
      &.large {
        .material-icons {
          font-size: clamp(24px, 8vw, 36px);
        }
      }
    }
  }

  .user-info {
    .user-name {
      margin: 0 0 clamp(3px, 1vw, 4px) 0;
      font-size: clamp(1rem, 3.5vw, 1.125rem);
      font-weight: 600;
      color: $text-primary;
      @include text-truncate;
    }

    .user-email {
      margin: 0 0 clamp(6px, 1.5vw, 8px) 0;
      font-size: clamp(0.8125rem, 2.5vw, 0.875rem);
      color: $text-secondary;
      @include text-truncate;
    }

    .user-account {
      margin: 0;
      @include flex-center;
      gap: clamp(4px, 1.5vw, 6px);
      font-size: clamp(0.75rem, 2.25vw, 0.8125rem);
      color: $text-light;

      .material-icons {
        font-size: clamp(14px, 3.5vw, 16px);
      }
    }
  }
}

.dropdown-menu {
  padding: clamp(6px, 1.5vw, 8px);

  .menu-item {
    @include flex-center;
    gap: clamp(12px, 3vw, 16px);
    padding: clamp(8px, 2.5vw, 12px) clamp(12px, 3vw, 16px);
    border-radius: clamp(6px, 1.5vw, 8px);
    text-decoration: none;
    color: #424242;
    font-size: clamp(0.8125rem, 2.5vw, 0.875rem);
    transition: all 0.2s ease;
    background: none;
    border: none;
    width: 100%;
    text-align: left;
    cursor: pointer;

    &:hover {
      background: #f5f5f5;
      color: $text-primary;
    }

    .material-icons {
      font-size: clamp(18px, 4.5vw, 20px);
      color: $text-secondary;
    }

    &.logout {
      color: $danger;

      .material-icons {
        color: $danger;
      }

      &:hover {
        background: #ffebee;
      }
    }
  }

  .menu-divider {
    height: 1px;
    background: #f0f0f0;
    margin: clamp(6px, 1.5vw, 8px) 0;
  }
}

// Overlay
.header-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.1);
  z-index: 99;
  animation: fadeIn 0.2s ease;
  backdrop-filter: blur(2px);
}

// Animations
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

// États de focus et accessibilité
.notification-button:focus-visible,
.profile-button:focus-visible,
.action-button:focus-visible,
.menu-toggle:focus-visible {
  outline: 2px solid $primary-green;
  outline-offset: 2px;
}

// Mode sombre (support préventif)
@media (prefers-color-scheme: dark) {
  .header {
    background: #1e1e1e;
    border-bottom-color: #333;

    .header-container {
      color: #ffffff;
    }

    .search-container {
      background: #2a2a2a;

      &:focus-within {
        background: #333;
      }
    }

    .search-input {
      color: #ffffff;

      &::placeholder {
        color: #888;
      }
    }

    .notifications-dropdown,
    .profile-dropdown {
      background: #2d2d2d;
      border-color: #444;
    }

    .dropdown-header,
    .user-card {
      background: #333;
      border-bottom-color: #444;
    }

    .notification-item,
    .menu-item {
      &:hover {
        background: #3a3a3a;
      }
    }
  }
}

// Accessibilité - Réduction de mouvement
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

// Support pour les écrans haute densité
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .profile-avatar img,
  .user-avatar img {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }
}

// Responsive pour différentes orientations
@media (max-height: 500px) and (orientation: landscape) {
  .header {
    --header-height: 48px;
    --header-mobile-height: 48px;
  }

  .notifications-dropdown,
  .profile-dropdown {
    max-height: 70vh;
    overflow-y: auto;
  }

  .user-card {
    padding: 12px;
  }

  .user-avatar {
    width: 40px !important;
    height: 40px !important;
    margin-bottom: 8px !important;
  }
}

// Support pour les écrans très larges
@media (min-width: 1400px) {
  .header-container {
    max-width: 1400px;
    margin-left: calc(var(--sidebar-width) + (100vw - 1400px) / 2);
    
    .sidebar.collapsed ~ .header & {
      margin-left: calc(var(--sidebar-collapsed-width) + (100vw - 1400px) / 2);
    }
  }
}

// Classes utilitaires
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

// États de chargement
.loading {
  pointer-events: none;
  opacity: 0.6;
  
  &::after {
    content: '';
    position: absolute;
    width: 16px;
    height: 16px;
    margin: auto;
    border: 2px solid transparent;
    border-top: 2px solid $primary-green;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

// États de focus améliorés
.notification-button,
.profile-button,
.action-button,
.menu-toggle {
  &:focus {
    outline: none;
  }

  &:focus-visible {
    outline: 2px solid $primary-green;
    outline-offset: 2px;
    border-radius: clamp(6px, 1.5vw, 8px);
  }
}

// Améliorations pour les dropdowns
.notifications-dropdown,
.profile-dropdown {
  // Animation d'entrée
  animation: slideDown 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  
  // Amélioration du scroll
  .notifications-content,
  .dropdown-menu {
    scrollbar-width: thin;
    scrollbar-color: $border transparent;
  }
}

// Gestion spéciale pour les écrans tactiles
@media (hover: none) {
  .action-button,
  .notification-button,
  .profile-button,
  .menu-item {
    min-height: 44px;
    min-width: 44px;
  }
  
  // Suppression des effets hover sur tactile
  .action-button:hover,
  .notification-button:hover,
  .profile-button:hover,
  .menu-item:hover {
    background: inherit;
    color: inherit;
  }
  
  // États actifs pour tactile
  .action-button:active,
  .notification-button:active,
  .profile-button:active,
  .menu-item:active {
    background: #f0f0f0;
    transform: scale(0.98);
  }
}

// Responsive pour tablettes en portrait
@media (max-width: 834px) and (orientation: portrait) {
  .header-center {
    max-width: 400px;
  }
  
  .notifications-dropdown,
  .profile-dropdown {
    width: calc(100vw - 32px);
    left: 16px;
    right: 16px;
  }
}

// Optimisations pour les performances
.header {
  // Utilisation de transform pour les animations
  will-change: transform;
  
  // Optimisation du rendu
  transform: translateZ(0);
}

.notifications-dropdown,
.profile-dropdown {
  will-change: opacity, transform;
  backface-visibility: hidden;
}

// Gestion des préférences de contraste élevé
@media (prefers-contrast: high) {
  .header {
    border-bottom-width: 2px;
  }
  
  .notification-badge {
    border: 2px solid white;
  }
  
  .status-dot {
    border: 1px solid white;
  }
}

// Styles d'impression
@media print {
  .header {
    position: static;
    box-shadow: none;
    border-bottom: 1px solid #000;
    
    .header-center,
    .quick-actions,
    .notifications-wrapper,
    .profile-wrapper {
      display: none;
    }
    
    .page-title {
      color: #000;
    }
  }
}

// Classes d'aide pour l'accessibilité
.visually-hidden {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

// Support pour les gestes de navigation
@supports (backdrop-filter: blur(10px)) {
  .header-overlay {
    backdrop-filter: blur(3px);
    background: rgba(0, 0, 0, 0.05);
  }
}

// Ajustements fins pour Safari
@supports (-webkit-backdrop-filter: blur(10px)) {
  .header {
    -webkit-backdrop-filter: saturate(180%) blur(10px);
    background: rgba(255, 255, 255, 0.8);
  }
}

// Optimisation pour les écrans OLED
@media (dynamic-range: high) {
  .notification-badge {
    background: color(display-p3 1 0.325 0.325);
  }
  
  .status-dot {
    background: color(display-p3 0.298 0.686 0.314);
  }
}

// Support pour les gestures sur touchpad
.header-container {
  touch-action: pan-x pan-y;
}

.search-input {
  touch-action: manipulation;
}

// Styles pour les états de connexion
.profile-status {
  .status-dot {
    transition: background-color 0.3s ease;
    
    &.offline {
      background: #9e9e9e;
    }
    
    &.away {
      background: $warning;
    }
    
    &.busy {
      background: $danger;
    }
  }
}

// Gestion des notifications push
.notification-item {
  &.priority-high {
    border-left: 3px solid $danger;
    
    .notification-icon {
      animation: pulse 2s infinite;
    }
  }
  
  &.priority-medium {
    border-left: 3px solid $warning;
  }
  
  &.priority-low {
    border-left: 3px solid $info;
  }
}

@keyframes pulse {
  0% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
  100% {
    opacity: 1;
  }
}

// Améliorations pour la recherche
.search-container {
  &.has-results {
    .search-icon {
      color: $primary-green;
    }
  }
  
  &.searching {
    .search-icon {
      animation: spin 1s linear infinite;
    }
  }
}

// États d'erreur
.notification-item.error {
  background: rgba(244, 67, 54, 0.05);
  border-left: 3px solid $danger;
}

.profile-button.error {
  .profile-avatar {
    border: 2px solid $danger;
  }
}

// Finalisation des media queries complexes
@media (max-width: 768px) and (orientation: landscape) {
  .header {
    --header-mobile-height: 48px;
  }
  
  .header-container {
    padding: 0 12px;
    gap: 8px;
  }
  
  .page-title {
    font-size: 1rem;
  }
}